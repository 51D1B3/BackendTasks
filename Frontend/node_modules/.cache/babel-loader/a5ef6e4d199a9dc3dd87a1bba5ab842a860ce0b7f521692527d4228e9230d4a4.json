{"ast":null,"code":"import _objectSpread from\"c:/Users/51D1B3/Documents/GestionTasks/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect,useCallback,useMemo}from'react';import{taskService}from'../services/api';export const useTasks=function(){let initialFilters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const[tasks,setTasks]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[filters,setFilters]=useState(initialFilters);const[meta,setMeta]=useState({total:0,page:1,limit:10,pages:0});const fetchTasks=useCallback(async function(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};setLoading(true);setError(null);try{const response=await taskService.getTasks(_objectSpread(_objectSpread({},filters),params));setTasks(response.data);setMeta(response.meta);}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Erreur lors du chargement des tâches');}finally{setLoading(false);}},[filters]);const createTask=useCallback(async taskData=>{try{const response=await taskService.createTask(taskData);await fetchTasks();return response;}catch(err){var _err$response2,_err$response2$data;throw new Error(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Erreur lors de la création de la tâche');}},[fetchTasks]);const updateTask=useCallback(async(id,taskData)=>{try{console.log('Tentative de mise à jour de la tâche:',{id,taskData});const response=await taskService.updateTask(id,taskData);console.log('Réponse du serveur:',response);// Le serveur retourne directement la tâche mise à jour\nconst updatedTask=response;setTasks(prevTasks=>prevTasks.map(task=>task._id===id?updatedTask:task));return updatedTask;}catch(err){var _err$response3,_err$response4,_err$response5,_err$response5$data;console.error('Erreur complète updateTask:',err);console.error('Réponse d\\'erreur:',err.response);console.error('Status:',(_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status);console.error('Data:',(_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.data);throw new Error(((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.message)||'Erreur lors de la mise à jour de la tâche');}},[]);const deleteTask=useCallback(async id=>{try{await taskService.deleteTask(id);setTasks(prevTasks=>prevTasks.filter(task=>task._id!==id));}catch(err){var _err$response6,_err$response6$data;throw new Error(((_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.message)||'Erreur lors de la suppression de la tâche');}},[]);const toggleTaskStatus=useCallback(async(id,currentStatus)=>{let newStatus;switch(currentStatus){case'todo':newStatus='in_progress';break;case'in_progress':newStatus='done';break;case'done':newStatus='todo';break;default:newStatus='todo';}try{const updatedTask=await updateTask(id,{status:newStatus});// Afficher un message de confirmation selon le nouveau statut\nif(newStatus==='done'){alert('✅ Tâche marquée comme terminée !');}else if(newStatus==='in_progress'){alert('▶ Tâche commencée !');}else if(newStatus==='todo'){alert('↶ Tâche rouverte !');}return updatedTask;}catch(error){throw error;}},[updateTask]);const filteredTasks=useMemo(()=>{return tasks.filter(task=>{if(filters.status&&task.status!==filters.status)return false;if(filters.priority&&task.priority!==filters.priority)return false;return true;});},[tasks,filters]);const taskStats=useMemo(()=>{return{total:tasks.length,todo:tasks.filter(t=>t.status==='todo').length,inProgress:tasks.filter(t=>t.status==='in_progress').length,done:tasks.filter(t=>t.status==='done').length,high:tasks.filter(t=>t.priority==='high').length,medium:tasks.filter(t=>t.priority==='medium').length,low:tasks.filter(t=>t.priority==='low').length};},[tasks]);useEffect(()=>{fetchTasks();},[fetchTasks]);return{tasks:filteredTasks,allTasks:tasks,loading,error,meta,filters,setFilters,fetchTasks,createTask,updateTask,deleteTask,toggleTaskStatus,taskStats};};","map":{"version":3,"names":["useState","useEffect","useCallback","useMemo","taskService","useTasks","initialFilters","arguments","length","undefined","tasks","setTasks","loading","setLoading","error","setError","filters","setFilters","meta","setMeta","total","page","limit","pages","fetchTasks","params","response","getTasks","_objectSpread","data","err","_err$response","_err$response$data","message","createTask","taskData","_err$response2","_err$response2$data","Error","updateTask","id","console","log","updatedTask","prevTasks","map","task","_id","_err$response3","_err$response4","_err$response5","_err$response5$data","status","deleteTask","filter","_err$response6","_err$response6$data","toggleTaskStatus","currentStatus","newStatus","alert","filteredTasks","priority","taskStats","todo","t","inProgress","done","high","medium","low","allTasks"],"sources":["c:/Users/51D1B3/Documents/GestionTasks/Frontend/src/hooks/useTasks.js"],"sourcesContent":["import { useState, useEffect, useCallback, useMemo } from 'react';\nimport { taskService } from '../services/api';\n\nexport const useTasks = (initialFilters = {}) => {\n  const [tasks, setTasks] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [filters, setFilters] = useState(initialFilters);\n  const [meta, setMeta] = useState({ total: 0, page: 1, limit: 10, pages: 0 });\n\n  const fetchTasks = useCallback(async (params = {}) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await taskService.getTasks({ ...filters, ...params });\n      setTasks(response.data);\n      setMeta(response.meta);\n    } catch (err) {\n      setError(err.response?.data?.message || 'Erreur lors du chargement des tâches');\n    } finally {\n      setLoading(false);\n    }\n  }, [filters]);\n\n  const createTask = useCallback(async (taskData) => {\n    try {\n      const response = await taskService.createTask(taskData);\n      await fetchTasks();\n      return response;\n    } catch (err) {\n      throw new Error(err.response?.data?.message || 'Erreur lors de la création de la tâche');\n    }\n  }, [fetchTasks]);\n\n  const updateTask = useCallback(async (id, taskData) => {\n    try {\n      console.log('Tentative de mise à jour de la tâche:', { id, taskData });\n      const response = await taskService.updateTask(id, taskData);\n      console.log('Réponse du serveur:', response);\n      \n      // Le serveur retourne directement la tâche mise à jour\n      const updatedTask = response;\n      setTasks(prevTasks => \n        prevTasks.map(task => task._id === id ? updatedTask : task)\n      );\n      return updatedTask;\n    } catch (err) {\n      console.error('Erreur complète updateTask:', err);\n      console.error('Réponse d\\'erreur:', err.response);\n      console.error('Status:', err.response?.status);\n      console.error('Data:', err.response?.data);\n      throw new Error(err.response?.data?.message || 'Erreur lors de la mise à jour de la tâche');\n    }\n  }, []);\n\n  const deleteTask = useCallback(async (id) => {\n    try {\n      await taskService.deleteTask(id);\n      setTasks(prevTasks => prevTasks.filter(task => task._id !== id));\n    } catch (err) {\n      throw new Error(err.response?.data?.message || 'Erreur lors de la suppression de la tâche');\n    }\n  }, []);\n\n  const toggleTaskStatus = useCallback(async (id, currentStatus) => {\n    let newStatus;\n    switch (currentStatus) {\n      case 'todo':\n        newStatus = 'in_progress';\n        break;\n      case 'in_progress':\n        newStatus = 'done';\n        break;\n      case 'done':\n        newStatus = 'todo';\n        break;\n      default:\n        newStatus = 'todo';\n    }\n    \n    try {\n      const updatedTask = await updateTask(id, { status: newStatus });\n      \n      // Afficher un message de confirmation selon le nouveau statut\n      if (newStatus === 'done') {\n        alert('✅ Tâche marquée comme terminée !');\n      } else if (newStatus === 'in_progress') {\n        alert('▶ Tâche commencée !');\n      } else if (newStatus === 'todo') {\n        alert('↶ Tâche rouverte !');\n      }\n      \n      return updatedTask;\n    } catch (error) {\n      throw error;\n    }\n  }, [updateTask]);\n\n  const filteredTasks = useMemo(() => {\n    return tasks.filter(task => {\n      if (filters.status && task.status !== filters.status) return false;\n      if (filters.priority && task.priority !== filters.priority) return false;\n      return true;\n    });\n  }, [tasks, filters]);\n\n  const taskStats = useMemo(() => {\n    return {\n      total: tasks.length,\n      todo: tasks.filter(t => t.status === 'todo').length,\n      inProgress: tasks.filter(t => t.status === 'in_progress').length,\n      done: tasks.filter(t => t.status === 'done').length,\n      high: tasks.filter(t => t.priority === 'high').length,\n      medium: tasks.filter(t => t.priority === 'medium').length,\n      low: tasks.filter(t => t.priority === 'low').length\n    };\n  }, [tasks]);\n\n  useEffect(() => {\n    fetchTasks();\n  }, [fetchTasks]);\n\n  return {\n    tasks: filteredTasks,\n    allTasks: tasks,\n    loading,\n    error,\n    meta,\n    filters,\n    setFilters,\n    fetchTasks,\n    createTask,\n    updateTask,\n    deleteTask,\n    toggleTaskStatus,\n    taskStats\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}